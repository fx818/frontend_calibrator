<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Certificate Extractor</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center min-h-screen bg-gray-100">
<div class="p-8 bg-white rounded-lg shadow-lg text-center w-full max-w-sm">
    <h1 class="text-3xl font-bold mb-2">Certificate Extractor</h1>
    <button id="loginBtn" class="px-6 py-3 bg-blue-600 text-white rounded-full hover:bg-blue-700">Sign in with Google</button>
    <div id="userInfo" class="hidden mt-4">
        <p>Welcome, <span id="userEmail"></span> ðŸŽ‰</p>
        <button id="logoutBtn" class="mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">Logout</button>
    </div>
</div>

<script>
const NGROK_URL = "https://7b41ee87f1e7.ngrok-free.app";

document.getElementById("loginBtn").onclick = () => {
    window.location.href = NGROK_URL + "/login";
};

document.getElementById("logoutBtn").onclick = async () => {
    await fetch(NGROK_URL + "/logout", { method: "POST", credentials: "include" });
    location.reload();
};

// Check login status
async function checkLogin() {
    try {
        const res = await fetch(NGROK_URL + "/me", { credentials: "include" });
        if (res.ok) {
            const data = await res.json();
            if (data.email) {
                document.getElementById("loginBtn").style.display = "none";
                document.getElementById("userInfo").style.display = "block";
                document.getElementById("userEmail").textContent = data.email;
            }
        }
    } catch (err) { console.error(err); }
}

checkLogin();
</script>
</body>
</html>
